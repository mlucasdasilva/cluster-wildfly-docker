version: '2'
#version: '3'

services:
 wild-dc:
  image: myimage/wildfly
  # console user/password -- admin/admin123 
  build: ./
  hostname: wild-dc
  volumes:
   - ./wild-docker-files/host-master.xml:/opt/jboss/wildfly/domain/configuration/host-master.xml
#   - ./volumes/wild1/deployments:/opt/jboss/wildfly/standalone/deployments
##   - ./wild-docker-files/apptest.war:/opt/jboss/wildfly/standalone/deployments/apptest.war
##   - ./wild-docker-files/apptest.war.dodeploy:/opt/jboss/wildfly/standalone/deployments/apptest.war.dodeploy
  ports:
   - "8080:8080"
   - "9990:9990"
  networks:
   wildnetwork:
      ipv4_address: 172.28.5.10
#  command: /opt/jboss/wildfly/bin/standalone.sh -c standalone-ha.xml -u 230.0.0.4
  command: /opt/jboss/wildfly/bin//domain.sh --host-config=host-master.xml -bmanagement=172.28.5.10
#  command: /opt/jboss/wildfly/bin/domain.sh --host-config host-slave.xml
#  command: /opt/jboss/wildfly/bin/domain.sh -b 0.0.0.0 -bmanagement 0.0.0.0


 wild-slave1:
  image: myimage/wildfly
  build: ./
  hostname: wild-slave1
  volumes:
   - ./wild-docker-files/host-slave.xml:/opt/jboss/wildfly/domain/configuration/host-slave.xml
#   - ./volumes/wild1/deployments:/opt/jboss/wildfly/standalone/deployments
##   - ./wild-docker-files/apptest.war:/opt/jboss/wildfly/standalone/deployments/apptest.war
##   - ./wild-docker-files/apptest.war.dodeploy:/opt/jboss/wildfly/standalone/deployments/apptest.war.dodeploy
  ports:
   - "8085:8080"
   - "9995:9990"
#  environment:
#   - jboss.domain.master.address=172.28.5.10
  networks:
   wildnetwork:
      ipv4_address: 172.28.5.15
#  command: /opt/jboss/wildfly/bin/standalone.sh -c standalone-ha.xml -u 230.0.0.4
#  command: /opt/jboss/wildfly/bin//domain.sh --host-config=host-master.xml -bmanagement=172.28.5.10
  command: /opt/jboss/wildfly/bin/domain.sh --host-config host-slave.xml -b 0.0.0.0 -bmanagement 0.0.0.0
#  command: /opt/jboss/wildfly/bin/domain.sh -b 0.0.0.0 -bmanagement 0.0.0.0


networks:
 wildnetwork:
#  driver: overlay
  driver: bridge
  ipam:
   config:
    - subnet: 172.28.0.0/16
      gateway: 172.28.5.254
#    - ip-range: 172.28.5.0/24
